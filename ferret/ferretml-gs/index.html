<!DOCTYPE html><html lang="en" dir="ltr" data-has-toc data-has-sidebar class="astro-bguv2lll"> <head><meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><title>Getting Started | Docs :: Morales Research Inc</title><link rel="canonical"/><link rel="shortcut icon" href="/favicon.svg" type="image/svg+xml"/><meta name="generator" content="Astro v4.0.8"/><meta name="generator" content="Starlight v0.15.1"/><meta property="og:title" content="Getting Started"/><meta property="og:type" content="article"/><meta property="og:url"/><meta property="og:locale" content="en"/><meta property="og:description" content="A guide to getting started with Apple's FerretML."/><meta property="og:site_name" content="Docs :: Morales Research Inc"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:title" content="Getting Started"/><meta name="twitter:description" content="A guide to getting started with Apple's FerretML."/><meta name="description" content="A guide to getting started with Apple's FerretML."/><script>
	window.StarlightThemeProvider = (() => {
		const storedTheme =
			typeof localStorage !== 'undefined' && localStorage.getItem('starlight-theme');
		const theme =
			storedTheme ||
			(window.matchMedia('(prefers-color-scheme: light)').matches ? 'light' : 'dark');
		document.documentElement.dataset.theme = theme === 'light' ? 'light' : 'dark';
		return {
			updatePickers(theme = storedTheme || 'auto') {
				document.querySelectorAll('starlight-theme-select').forEach((picker) => {
					const select = picker.querySelector('select');
					if (select) select.value = theme;
					/** @type {HTMLTemplateElement | null} */
					const tmpl = document.querySelector(`#theme-icons`);
					const newIcon = tmpl && tmpl.content.querySelector('.' + theme);
					if (newIcon) {
						const oldIcon = picker.querySelector('svg.label-icon');
						if (oldIcon) {
							oldIcon.replaceChildren(...newIcon.cloneNode(true).childNodes);
						}
					}
				});
			},
		};
	})();
</script><template id="theme-icons"><svg aria-hidden="true" class="light astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M5 12a1 1 0 0 0-1-1H3a1 1 0 0 0 0 2h1a1 1 0 0 0 1-1Zm.64 5-.71.71a1 1 0 0 0 0 1.41 1 1 0 0 0 1.41 0l.71-.71A1 1 0 0 0 5.64 17ZM12 5a1 1 0 0 0 1-1V3a1 1 0 0 0-2 0v1a1 1 0 0 0 1 1Zm5.66 2.34a1 1 0 0 0 .7-.29l.71-.71a1 1 0 1 0-1.41-1.41l-.66.71a1 1 0 0 0 0 1.41 1 1 0 0 0 .66.29Zm-12-.29a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.71-.71a1.004 1.004 0 1 0-1.43 1.41l.73.71ZM21 11h-1a1 1 0 0 0 0 2h1a1 1 0 0 0 0-2Zm-2.64 6A1 1 0 0 0 17 18.36l.71.71a1 1 0 0 0 1.41 0 1 1 0 0 0 0-1.41l-.76-.66ZM12 6.5a5.5 5.5 0 1 0 5.5 5.5A5.51 5.51 0 0 0 12 6.5Zm0 9a3.5 3.5 0 1 1 0-7 3.5 3.5 0 0 1 0 7Zm0 3.5a1 1 0 0 0-1 1v1a1 1 0 0 0 2 0v-1a1 1 0 0 0-1-1Z"/></svg> <svg aria-hidden="true" class="dark astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.64 13a1 1 0 0 0-1.05-.14 8.049 8.049 0 0 1-3.37.73 8.15 8.15 0 0 1-8.14-8.1 8.59 8.59 0 0 1 .25-2A1 1 0 0 0 8 2.36a10.14 10.14 0 1 0 14 11.69 1 1 0 0 0-.36-1.05Zm-9.5 6.69A8.14 8.14 0 0 1 7.08 5.22v.27a10.15 10.15 0 0 0 10.14 10.14 9.784 9.784 0 0 0 2.1-.22 8.11 8.11 0 0 1-7.18 4.32v-.04Z"/></svg> <svg aria-hidden="true" class="auto astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg> </template><link rel="stylesheet" href="/_astro/index.KH6lfnST.css" />
<style>svg:where(.astro-c6vsoqas){color:var(--sl-icon-color);font-size:var(--sl-icon-size, 1em);width:1em;height:1em}
</style><script type="module" src="/_astro/hoisted.dSDs6aBR.js"></script>
<script type="module" src="/_astro/page.36aCzv65.js"></script></head> <body class="astro-bguv2lll"> <a href="#_top" class="astro-7q3lir66">Skip to content</a>  <div class="page sl-flex astro-vrdttmbt"> <header class="header astro-vrdttmbt"><div class="header sl-flex astro-kmkmnagf"> <div class="sl-flex astro-kmkmnagf"> <a href="/" class="site-title sl-flex astro-m46x6ez3">  <span class="astro-m46x6ez3"> Docs :: Morales Research Inc </span> </a>  </div> <div class="sl-flex astro-kmkmnagf"> <site-search data-translations="{&#34;placeholder&#34;:&#34;Search&#34;}" class="astro-v37mnknz"> <button data-open-modal disabled class="astro-v37mnknz">  <svg aria-label="Search" class="astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21.71 20.29 18 16.61A9 9 0 1 0 16.61 18l3.68 3.68a.999.999 0 0 0 1.42 0 1 1 0 0 0 0-1.39ZM11 18a7 7 0 1 1 0-14 7 7 0 0 1 0 14Z"/></svg>  <span class="sl-hidden md:sl-block astro-v37mnknz" aria-hidden="true">Search</span> <svg aria-label="(Press / to Search)" class="sl-hidden md:sl-block astro-v37mnknz astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 2H7a5 5 0 0 0-5 5v10a5 5 0 0 0 5 5h10a5 5 0 0 0 5-5V7a5 5 0 0 0-5-5Zm3 15a3 3 0 0 1-3 3H7a3 3 0 0 1-3-3V7a3 3 0 0 1 3-3h10a3 3 0 0 1 3 3v10Z"/><path d="M15.293 6.707a1 1 0 1 1 1.414 1.414l-8.485 8.486a1 1 0 0 1-1.414-1.415l8.485-8.485Z"/></svg>  </button> <dialog style="padding:0" aria-label="Search" class="astro-v37mnknz"> <div class="dialog-frame sl-flex astro-v37mnknz">  <button data-close-modal class="sl-flex md:sl-hidden astro-v37mnknz"> Cancel </button> <div class="search-container astro-v37mnknz"> <div id="starlight__search" class="astro-v37mnknz"></div> </div> </div> </dialog> </site-search>    </div> <div class="sl-hidden md:sl-flex right-group astro-kmkmnagf"> <div class="sl-flex social-icons astro-kmkmnagf"> <a href="https://git.moralesresearch.org/web/documentation" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div> </div> </header> <nav class="sidebar astro-vrdttmbt" aria-label="Main"> <starlight-menu-button class="astro-jif73yzw"> <button aria-expanded="false" aria-label="Menu" aria-controls="starlight__sidebar" class="sl-flex md:sl-hidden astro-jif73yzw"> <svg aria-hidden="true" class="astro-jif73yzw astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M3 8h18a1 1 0 1 0 0-2H3a1 1 0 0 0 0 2Zm18 8H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Zm0-5H3a1 1 0 0 0 0 2h18a1 1 0 0 0 0-2Z"/></svg>  </button> </starlight-menu-button>    <div id="starlight__sidebar" class="sidebar-pane astro-vrdttmbt"> <div class="sidebar-content sl-flex astro-vrdttmbt"> <ul class="top-level astro-3ii7xxms"> <li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Welcome</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/welcome/gettingstarted/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Getting Started</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">Ferret ML</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/ferret/ferretml-gs/" aria-current="page" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Getting Started on Ferret ML</span>  </a> </li> </ul>  </details> </li><li class="astro-3ii7xxms"> <details open class="astro-3ii7xxms"> <summary class="astro-3ii7xxms"> <div class="group-label astro-3ii7xxms"> <span class="large astro-3ii7xxms">References</span>  </div> <svg aria-hidden="true" class="caret astro-3ii7xxms astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.25rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </summary> <ul class="astro-3ii7xxms"> <li class="astro-3ii7xxms"> <a href="/reference/example/" class="astro-3ii7xxms"> <span class="astro-3ii7xxms">Example Reference</span>  </a> </li> </ul>  </details> </li> </ul>  <div class="md:sl-hidden"> <div class="mobile-preferences sl-flex astro-wu23bvmt"> <div class="sl-flex social-icons astro-wu23bvmt"> <a href="https://git.moralesresearch.org/web/documentation" rel="me" class="sl-flex astro-wy4te6ga"><span class="sr-only astro-wy4te6ga">GitHub</span><svg aria-hidden="true" class="astro-wy4te6ga astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M12 .3a12 12 0 0 0-3.8 23.38c.6.12.83-.26.83-.57L9 21.07c-3.34.72-4.04-1.61-4.04-1.61-.55-1.39-1.34-1.76-1.34-1.76-1.08-.74.09-.73.09-.73 1.2.09 1.83 1.24 1.83 1.24 1.08 1.83 2.81 1.3 3.5 1 .1-.78.42-1.31.76-1.61-2.67-.3-5.47-1.33-5.47-5.93 0-1.31.47-2.38 1.24-3.22-.14-.3-.54-1.52.1-3.18 0 0 1-.32 3.3 1.23a11.5 11.5 0 0 1 6 0c2.28-1.55 3.29-1.23 3.29-1.23.64 1.66.24 2.88.12 3.18a4.65 4.65 0 0 1 1.23 3.22c0 4.61-2.8 5.63-5.48 5.92.42.36.81 1.1.81 2.22l-.01 3.29c0 .31.2.69.82.57A12 12 0 0 0 12 .3Z"/></svg> </a> </div> <starlight-theme-select>  <label style="--sl-select-width: 6.25em" class="astro-4yphtoen"> <span class="sr-only astro-4yphtoen">Select theme</span> <svg aria-hidden="true" class="icon label-icon astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M21 14h-1V7a3 3 0 0 0-3-3H7a3 3 0 0 0-3 3v7H3a1 1 0 0 0-1 1v2a3 3 0 0 0 3 3h14a3 3 0 0 0 3-3v-2a1 1 0 0 0-1-1ZM6 7a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v7H6V7Zm14 10a1 1 0 0 1-1 1H5a1 1 0 0 1-1-1v-1h16v1Z"/></svg>  <select value="auto" class="astro-4yphtoen"> <option value="dark" class="astro-4yphtoen">Dark</option><option value="light" class="astro-4yphtoen">Light</option><option value="auto" selected="true" class="astro-4yphtoen">Auto</option> </select> <svg aria-hidden="true" class="icon caret astro-4yphtoen astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1em;"><path d="M17 9.17a1 1 0 0 0-1.41 0L12 12.71 8.46 9.17a1 1 0 1 0-1.41 1.42l4.24 4.24a1.002 1.002 0 0 0 1.42 0L17 10.59a1.002 1.002 0 0 0 0-1.42Z"/></svg>  </label>  </starlight-theme-select>  <script>
	StarlightThemeProvider.updatePickers();
</script>   </div>  </div> </div> </div> </nav> <div class="main-frame astro-vrdttmbt">  <div class="lg:sl-flex astro-67yu43on"> <aside class="right-sidebar-container astro-67yu43on"> <div class="right-sidebar astro-67yu43on"> <div class="lg:sl-hidden astro-pb3aqygn"><mobile-starlight-toc data-min-h="2" data-max-h="3" class="astro-doynk5tl"><nav aria-labelledby="starlight__on-this-page--mobile" class="astro-doynk5tl"><details id="starlight__mobile-toc" class="astro-doynk5tl"><summary id="starlight__on-this-page--mobile" class="sl-flex astro-doynk5tl"><div class="toggle sl-flex astro-doynk5tl">On this page<svg aria-hidden="true" class="caret astro-doynk5tl astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1rem;"><path d="m14.83 11.29-4.24-4.24a1 1 0 1 0-1.42 1.41L12.71 12l-3.54 3.54a1 1 0 0 0 0 1.41 1 1 0 0 0 .71.29 1 1 0 0 0 .71-.29l4.24-4.24a1.002 1.002 0 0 0 0-1.42Z"/></svg> </div><span class="display-current astro-doynk5tl"></span></summary><div class="dropdown astro-doynk5tl"><ul class="isMobile astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#release" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Release</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#contents" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Contents</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#install" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Install</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#train" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Train</span> </a> <ul class="isMobile astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#hyperparameters" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Hyperparameters</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#prepare-vicuna-checkpoint-and-llavas-projector" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Prepare Vicuna checkpoint and LLaVA’s projector</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#ferret-training" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">FERRET Training</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#evaluation" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Evaluation</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#checkpoints" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Checkpoints</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#demo" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Demo</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#citation" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Citation</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#acknowledgement" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Acknowledgement</span> </a>  </li> </ul> </div></details></nav></mobile-starlight-toc></div><div class="right-sidebar-panel sl-hidden lg:sl-block astro-pb3aqygn"><div class="sl-container astro-pb3aqygn"><starlight-toc data-min-h="2" data-max-h="3"><nav aria-labelledby="starlight__on-this-page"><h2 id="starlight__on-this-page">On this page</h2><ul class="astro-g2bywc46" style="--depth: 0;"> <li class="astro-g2bywc46" style="--depth: 0;"> <a href="#_top" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Overview</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#release" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Release</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#contents" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Contents</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#install" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Install</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#train" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Train</span> </a> <ul class="astro-g2bywc46" style="--depth: 1;"> <li class="astro-g2bywc46" style="--depth: 1;"> <a href="#hyperparameters" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Hyperparameters</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#prepare-vicuna-checkpoint-and-llavas-projector" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">Prepare Vicuna checkpoint and LLaVA’s projector</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 1;"> <a href="#ferret-training" class="astro-g2bywc46" style="--depth: 1;"> <span class="astro-g2bywc46" style="--depth: 1;">FERRET Training</span> </a>  </li> </ul>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#evaluation" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Evaluation</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#checkpoints" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Checkpoints</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#demo" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Demo</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#citation" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Citation</span> </a>  </li><li class="astro-g2bywc46" style="--depth: 0;"> <a href="#acknowledgement" class="astro-g2bywc46" style="--depth: 0;"> <span class="astro-g2bywc46" style="--depth: 0;">Acknowledgement</span> </a>  </li> </ul> </nav></starlight-toc></div></div> </div> </aside> <div class="main-pane astro-67yu43on">  <main data-pagefind-body lang="en" dir="ltr" class="astro-bguv2lll">    <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <h1 id="_top" class="astro-j6tvhyss">Getting Started</h1>  </div> </div>  <div class="content-panel astro-7nkwcw3z"> <div class="sl-container astro-7nkwcw3z"> <div class="sl-markdown-content"> <!-- # Project Name

This software project accompanies the research paper, [Paper title](https://arxiv.org).

Brief description of the project.

## Documentation

## Getting Started  -->
<p><a href="https://hxyou.github.io/">Haoxuan You*</a>, <a href="https://haotian-zhang.github.io/">Haotian Zhang*</a>, <a href="https://zhegan27.github.io/">Zhe Gan</a>, <a href="https://scholar.google.com/citations?user=l1hP40AAAAAJ&#x26;hl=en">Xianzhi Du</a>, <a href="https://zbwglory.github.io/">Bowen Zhang</a>, <a href="https://www.cs.cmu.edu/~ziruiw/">Zirui Wang</a>, <a href="http://llcao.net/">Liangliang Cao</a>, <a href="https://www.ee.columbia.edu/~sfchang/">Shih-Fu Chang</a>, <a href="https://sites.google.com/site/yinfeiyang/">Yinfei Yang</a>
[*: equal contribution]</p>
<p align="center">
    <img src="../../../assets/ferret_fig_diagram_v2.png" width="100%"> <br>
    Diagram of Ferret Model.
</p>
<p>Key Contributions:</p>
<ul>
<li>Ferret Model - <strong>Hybrid Region Representation + Spatial-aware Visual Sampler</strong> enable fine-grained and open-vocabulary referring and grounding in MLLM.</li>
<li>GRIT Dataset (~1.1M) - A <strong>Large-scale, Hierarchical, Robust</strong> ground-and-refer instruction tuning dataset.</li>
<li>Ferret-Bench - A multimodal evaluation benchmark that jointly requires <strong>Referring/Grounding, Semantics, Knowledge, and Reasoning</strong>.</li>
</ul>
<h2 id="release">Release</h2>
<ul>
<li>[12/14] 🔥 We released the <a href="#checkpoints">checkpoints(7B, 13B)</a>.</li>
<li>[10/30] 🔥 We released the code of <strong>FERRET</strong> model and <a href="ferret/eval/ferret_gpt4_data">Ferret-Bench</a>.</li>
</ul>
<p><strong>Usage and License Notices</strong>: The data, and code is intended and licensed for research use only. They are also restricted to uses that follow the license agreement of LLaMA, Vicuna and GPT-4. The dataset is CC BY NC 4.0 (allowing only non-commercial use) and models trained using the dataset should not be used outside of research purposes.</p>
<h2 id="contents">Contents</h2>
<ul>
<li><a href="#install">Install</a></li>
<li><a href="#train">Train</a></li>
<li><a href="#evaluation">Evaluation</a></li>
<li><a href="#demo">Demo</a></li>
</ul>
<h2 id="install">Install</h2>
<ol>
<li>Clone this repository and navigate to FERRET folder</li>
</ol>
<div class="expressive-code"><link rel="stylesheet" href="/_astro/ec.0epgx.css"><script type="module" src="/_astro/ec.sgewm.js"></script><figure class="frame is-terminal not-content"><figcaption class="header"><span class="title"></span><span class="sr-only">Terminal window</span></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#82AAFF;--1:#3B61B0">git</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3B61B0">clone</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3B61B0">https://github.com/apple/ml-ferret</span></div><div class="ec-line"><span style="--0:#C5E478;--1:#3B61B0">cd</span><span style="--0:#D6DEEB;--1:#403F53"> </span><span style="--0:#ECC48D;--1:#3B61B0">ml-ferret</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="git clone https://github.com/apple/ml-ferretcd ml-ferret"><div></div></button></div></figure></div>
<ol start="2">
<li>Install Package</li>
</ol>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">conda create -n ferret python=3.10 -y</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">conda activate ferret</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">pip install --upgrade pip  # enable PEP 660 support</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">pip install -e .</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">pip install pycocotools</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">pip install protobuf==3.20.0</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="conda create -n ferret python=3.10 -yconda activate ferretpip install --upgrade pip  # enable PEP 660 supportpip install -e .pip install pycocotoolspip install protobuf==3.20.0"><div></div></button></div></figure></div>
<ol start="3">
<li>Install additional packages for training cases</li>
</ol>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">pip install ninja</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">pip install flash-attn --no-build-isolation</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="pip install ninjapip install flash-attn --no-build-isolation"><div></div></button></div></figure></div>
<h2 id="train">Train</h2>
<p>FERRET is trained on 8 A100 GPUs with 80GB memory. To train on fewer GPUs, you can reduce the <code dir="auto">per_device_train_batch_size</code> and increase the <code dir="auto">gradient_accumulation_steps</code> accordingly. Always keep the global batch size the same: <code dir="auto">per_device_train_batch_size</code> x <code dir="auto">gradient_accumulation_steps</code> x <code dir="auto">num_gpus</code>.</p>
<h3 id="hyperparameters">Hyperparameters</h3>
<p>We use a similar set of hyperparameters as LLaVA(Vicuna) in finetuning.</p>





























<table><thead><tr><th>Hyperparameter</th><th align="right">Global Batch Size</th><th align="right">Learning rate</th><th align="right">Epochs</th><th align="right">Max length</th><th align="right">Weight decay</th></tr></thead><tbody><tr><td>FERRET-7B</td><td align="right">128</td><td align="right">2e-5</td><td align="right">3</td><td align="right">2048</td><td align="right">0</td></tr><tr><td>FERRET-13B</td><td align="right">128</td><td align="right">2e-5</td><td align="right">3</td><td align="right">2048</td><td align="right">0</td></tr></tbody></table>
<h3 id="prepare-vicuna-checkpoint-and-llavas-projector">Prepare Vicuna checkpoint and LLaVA’s projector</h3>
<p>Before you start, prepare our base model Vicuna, which is an instruction-tuned chatbot. Please download its weights following the instructions <a href="https://github.com/lm-sys/FastChat#model-weights">here</a>. Vicuna v1.3 is used in FERRET.</p>
<p>Then download LLaVA’s first-stage pre-trained projector weight (<a href="https://huggingface.co/liuhaotian/llava-336px-pretrain-vicuna-7b-v1.3">7B</a>, <a href="https://huggingface.co/liuhaotian/llava-336px-pretrain-vicuna-13b-v1.3">13B</a>).</p>
<h3 id="ferret-training">FERRET Training</h3>
<p>The scripts are provided (<a href="experiments/ferret_7b_train.sh">7B</a>, <a href="experiments/ferret_13b_train.sh">13B</a>).</p>
<h2 id="evaluation">Evaluation</h2>
<p>Please see this <a href="EVAL.md">doc</a> for the details.</p>
<h2 id="checkpoints">Checkpoints</h2>
<p>We extracted the <code dir="auto">delta</code> between our pre-trained model and Vicuna. Please first download weights of Vicuna following the <a href="#prepare-vicuna-checkpoint-and-llavas-projector">previous instruction</a>. Then download our prepared offsets of weights: <a href="https://docs-assets.developer.apple.com/ml-research/models/ferret/ferret-7b/ferret-7b-delta.zip">7B</a>, <a href="https://docs-assets.developer.apple.com/ml-research/models/ferret/ferret-13b/ferret-13b-delta.zip">13B</a> using <code dir="auto">wget</code> or <code dir="auto">curl</code>, and unzip the downloaded offsets. Lastly, apply the offset to the Vicuna’s weight by running the following script:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53"># 7B</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">python3 -m ferret.model.apply_delta \</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">    --base ./model/vicuna-7b-v1-3 \</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">    --target ./model/ferret-7b-v1-3 \</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">    --delta path/to/ferret-7b-delta</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53"># 13B</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">python3 -m ferret.model.apply_delta \</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">    --base ./model/vicuna-13b-v1-3 \</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">    --target ./model/ferret-13b-v1-3 \</span></div><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">    --delta path/to/ferret-13b-delta</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="# 7Bpython3 -m ferret.model.apply_delta \    --base ./model/vicuna-7b-v1-3 \    --target ./model/ferret-7b-v1-3 \    --delta path/to/ferret-7b-delta# 13Bpython3 -m ferret.model.apply_delta \    --base ./model/vicuna-13b-v1-3 \    --target ./model/ferret-13b-v1-3 \    --delta path/to/ferret-13b-delta"><div></div></button></div></figure></div>
<p><strong>Notices</strong>: Apple’s rights in the attached weight differentials are hereby licensed under the CC-BY-NC license. Apple makes no representations with regards to LLaMa or any other third party software, which are subject to their own terms.</p>
<p>Please refer to the next section about how to set up a local demo with pre-trained weight.</p>
<h2 id="demo">Demo</h2>
<p>To run our demo, you need to train FERRET and use the checkpoints locally. Gradio web UI is used. Please run the following commands one by one.</p>
<h4 id="launch-a-controller">Launch a controller</h4>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">python -m ferret.serve.controller --host 0.0.0.0 --port 10000</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="python -m ferret.serve.controller --host 0.0.0.0 --port 10000"><div></div></button></div></figure></div>
<h4 id="launch-a-gradio-web-server">Launch a gradio web server.</h4>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">python -m ferret.serve.gradio_web_server --controller http://localhost:10000 --model-list-mode reload --add_region_feature</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="python -m ferret.serve.gradio_web_server --controller http://localhost:10000 --model-list-mode reload --add_region_feature"><div></div></button></div></figure></div>
<h4 id="launch-a-model-worker">Launch a model worker</h4>
<p>This is the worker that load the ckpt and do the inference on the GPU.  Each worker is responsible for a single model specified in <code dir="auto">--model-path</code>.</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#d6deeb;--1:#403f53">CUDA_VISIBLE_DEVICES=0 python -m ferret.serve.model_worker --host 0.0.0.0 --controller http://localhost:10000 --port 40000 --worker http://localhost:40000 --model-path ./checkpoints/FERRET-13B-v0 --add_region_feature</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="CUDA_VISIBLE_DEVICES=0 python -m ferret.serve.model_worker --host 0.0.0.0 --controller http://localhost:10000 --port 40000 --worker http://localhost:40000 --model-path ./checkpoints/FERRET-13B-v0 --add_region_feature"><div></div></button></div></figure></div>
<p>Wait until the process finishes loading the model and you see “Uvicorn running on …“.  Now, refresh your Gradio web UI, and you will see the model you just launched in the model list.</p>
<p align="center">
    <img src="../../../ferret_demo.webp" width="105%"> <br>
    Example of Ferret Interactive Demo.
</p>
<h2 id="citation">Citation</h2>
<p>If you find Ferret useful, please cite using this BibTeX:</p>
<div class="expressive-code"><figure class="frame not-content"><figcaption class="header"></figcaption><pre tabindex="0"><code><div class="ec-line"><span style="--0:#C792EA;--1:#8844AE">@article</span><span style="--0:#D6DEEB;--1:#403F53">{you2023ferret,</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#C5E478;--1:#3B61B0">title</span><span style="--0:#D6DEEB;--1:#403F53">=</span><span style="--0:#D9F5DD;--1:#111111">{</span><span style="--0:#D6DEEB;--1:#403F53">Ferret: Refer and Ground Anything Anywhere at Any Granularity</span><span style="--0:#D9F5DD;--1:#111111">}</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#C5E478;--1:#3B61B0">author</span><span style="--0:#D6DEEB;--1:#403F53">=</span><span style="--0:#D9F5DD;--1:#111111">{</span><span style="--0:#D6DEEB;--1:#403F53">You, Haoxuan and Zhang, Haotian and Gan, Zhe and Du, Xianzhi and Zhang, Bowen and Wang, Zirui and Cao, Liangliang and Chang, Shih-Fu and Yang, Yinfei</span><span style="--0:#D9F5DD;--1:#111111">}</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#C5E478;--1:#3B61B0">journal</span><span style="--0:#D6DEEB;--1:#403F53">=</span><span style="--0:#D9F5DD;--1:#111111">{</span><span style="--0:#D6DEEB;--1:#403F53">arXiv preprint arXiv:2310.07704</span><span style="--0:#D9F5DD;--1:#111111">}</span><span style="--0:#D6DEEB;--1:#403F53">,</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">  </span><span style="--0:#C5E478;--1:#3B61B0">year</span><span style="--0:#D6DEEB;--1:#403F53">=</span><span style="--0:#D9F5DD;--1:#111111">{</span><span style="--0:#D6DEEB;--1:#403F53">2023</span><span style="--0:#D9F5DD;--1:#111111">}</span></div><div class="ec-line"><span style="--0:#D6DEEB;--1:#403F53">}</span></div></code></pre><div class="copy"><button title="Copy to clipboard" data-copied="Copied!" data-code="@article{you2023ferret,  title={Ferret: Refer and Ground Anything Anywhere at Any Granularity},  author={You, Haoxuan and Zhang, Haotian and Gan, Zhe and Du, Xianzhi and Zhang, Bowen and Wang, Zirui and Cao, Liangliang and Chang, Shih-Fu and Yang, Yinfei},  journal={arXiv preprint arXiv:2310.07704},  year={2023}}"><div></div></button></div></figure></div>
<h2 id="acknowledgement">Acknowledgement</h2>
<ul>
<li><a href="https://github.com/haotian-liu/LLaVA">LLaVA</a>: the codebase we built upon.</li>
<li><a href="https://github.com/lm-sys/FastChat">Vicuna</a>: the LLM codebase.</li>
</ul> </div> <footer class="astro-3yyafb3n"> <div class="meta sl-flex astro-3yyafb3n">   </div> <div class="pagination-links astro-u2l5gyhi" dir="ltr"> <a href="/welcome/gettingstarted/" rel="prev" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17 11H9.41l3.3-3.29a1.004 1.004 0 1 0-1.42-1.42l-5 5a1 1 0 0 0-.21.33 1 1 0 0 0 0 .76 1 1 0 0 0 .21.33l5 5a1.002 1.002 0 0 0 1.639-.325 1 1 0 0 0-.219-1.095L9.41 13H17a1 1 0 0 0 0-2Z"/></svg>  <span class="astro-u2l5gyhi"> Previous <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Getting Started</span> </span> </a> <a href="/reference/example/" rel="next" class="astro-u2l5gyhi"> <svg aria-hidden="true" class="astro-u2l5gyhi astro-c6vsoqas" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" style="--sl-icon-size: 1.5rem;"><path d="M17.92 11.62a1.001 1.001 0 0 0-.21-.33l-5-5a1.003 1.003 0 1 0-1.42 1.42l3.3 3.29H7a1 1 0 0 0 0 2h7.59l-3.3 3.29a1.002 1.002 0 0 0 .325 1.639 1 1 0 0 0 1.095-.219l5-5a1 1 0 0 0 .21-.33 1 1 0 0 0 0-.76Z"/></svg>  <span class="astro-u2l5gyhi"> Next <br class="astro-u2l5gyhi"> <span class="link-title astro-u2l5gyhi">Example Reference</span> </span> </a> </div>  </footer>  </div> </div>   </main> </div> </div>  </div> </div>  </body></html>